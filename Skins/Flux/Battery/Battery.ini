[Rainmeter]
Author = bedoy
Update = 1000

[Variables]
Scale = 0.75
OffsetX = 0
OffsetY = 0

ShellColor = 255, 255, 255

DefaultPercentageColor = 255, 255, 255
ChargingColor = 33, 153, 161
HighColor = 195, 246, 105
MiddleColor = 207, 146, 79
LowColor = 219, 45, 52

ShellOpacity = 230
PercentageOpacity = 245

ShellWidth = 550
ShellHeight = 290
ShellThickness = 30

OuterRadius = 55
InnerRadius = 30
PercentageRadius = 20

PercentageSpacing = 20

PoleWidth = 42
PoleHeight = 85
PoleRadius = 13
SmoothPoleTransition = 1

[ScriptScaler]
Measure=Script
ScriptFile=#@#\Scripts\Scale.lua
Scale = #Scale#
Variables = ShellWidth|ShellHeight|ShellThickness|OuterRadius|InnerRadius|PercentageRadius|PercentageSpacing|PoleWidth|PoleHeight|PoleRadius
DynamicVariables = 1

[MeasureBattery]
Measure=Plugin
Plugin=PowerPlugin.dll
PowerState=PERCENT

[MeasurePowerSource]
Measure=Plugin
Plugin=PowerPlugin.dll
PowerState=ACLINE
Substitute="1":"AC","0":"Battery"

[ScriptShellColor]
Measure=Script
ScriptFile=#@#\Scripts\Battery.lua

[BatteryShellMeter]
Meter=Shape
MeasureName=MeasureBattery
X= #OffsetX#
Y= #OffsetY#
Shape=Rectangle 0,0,#ShellWidth#,#ShellHeight#,#OuterRadius# | Fill Color #ShellColor#,#ShellOpacity# | StrokeWidth 0
Shape2=Rectangle #ShellThickness#, #ShellThickness#, (#ShellWidth# -  (2 * #ShellThickness#)), (#ShellHeight# - (2 * #ShellThickness#)), #InnerRadius#
Shape3=Combine Shape | Exclude Shape2

DynamicVariables = 1
UpdateDivider = -1

[BatteryPercentageMeter]
Meter=Shape
MeasureName=MeasureBattery
X=(#ShellThickness# + #PercentageSpacing# + #OffsetX#)
Y=(#ShellThickness# + #PercentageSpacing# + #OffsetY#)
Shape=Rectangle 0, 0, ((#ShellWidth# - (2 * (#ShellThickness# + #PercentageSpacing#))) * [MeasureBattery] / 100), (#ShellHeight# - (2 * (#ShellThickness# + #PercentageSpacing#))), #PercentageRadius# | Fill Color #DefaultPercentageColor#,#PercentageOpacity# | StrokeWidth 0
DynamicVariables = 1

[MeasureSmoothPoleTransition]
Measure=Calc
Formula=#SmoothPoleTransition#
IfAboveValue=0
IfAboveAction=[!SetVariable SmoothPoleTransition #ShellOpacity#]
UpdateDivider = -1

[PoleMeter]
Meter=Shape
MeasureName=MeasureBattery
X = (#ShellWidth# + #OffsetX#)
Y = (((#ShellHeight# - (3 * #PoleHeight#)) / 2) + #OffsetY#)

Shape=Rectangle 0,0,#PoleWidth#,#PoleHeight#,0 | Fill Color #ShellColor#,#SmoothPoleTransition# | StrokeWidth 0
Shape2=Rectangle 0,0,#PoleWidth#,#PoleRadius#,0
Shape3=Rectangle (#PoleWidth# - #PoleRadius#),0,#PoleRadius#,#PoleHeight#,0
Shape4=Rectangle 0,0,#PoleWidth#,#PoleHeight#,#PoleRadius#
Shape5=Combine Shape | Exclude Shape2 | Exclude Shape3 | Exclude Shape4

Shape6=Rectangle 0,(2 * #PoleHeight#),#PoleWidth#,#PoleHeight#,0 | Fill Color #ShellColor#,#SmoothPoleTransition# | StrokeWidth 0
Shape7=Rectangle 0,((3 * #PoleHeight#) - #PoleRadius#),#PoleWidth#,#PoleRadius#,0
Shape8=Rectangle (#PoleWidth# - #PoleRadius#),(2 * #PoleHeight#),#PoleRadius#,#PoleHeight#,0
Shape9=Rectangle 0,(2 * #PoleHeight#),#PoleWidth#,#PoleHeight#,#PoleRadius#
Shape10=Combine Shape6 | Exclude Shape7 | Exclude Shape8 | Exclude Shape9

Shape11=Rectangle (-#PoleRadius#),#PoleHeight#,#PoleWidth#,#PoleHeight#,#PoleRadius# | Fill Color #ShellColor#,#ShellOpacity# | StrokeWidth 0
Shape12=Rectangle (-#PoleRadius#),#PoleHeight#,#PoleRadius#,#PoleHeight#,0
Shape13 = Combine Shape11 | Exclude Shape12

DynamicVariables = 1
UpdateDivider = -1